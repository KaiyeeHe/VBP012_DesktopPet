<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡‘é’±è±¹æ¡Œé¢å® ç‰© - æœ€ç»ˆç‰ˆ</title>
    <style>
        /* === åŸºç¡€ç¯å¢ƒ === */
        body {
            background-color: #f0f0f0; /* æ¨¡æ‹Ÿæ¡Œé¢ç¯å¢ƒï¼Œæ‰“åŒ…APPæ—¶å¯è®¾ä¸ºé€æ˜ */
            margin: 0;
            overflow: hidden;
            font-family: 'Comic Sans MS', 'Chalkboard SE', 'Microsoft YaHei', sans-serif;
            user-select: none; /* ç¦æ­¢é€‰ä¸­æ–‡æœ¬ */
        }

        /* === 1. é¡¶éƒ¨çŠ¶æ€æ  === */
        #piggy-bank {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px 16px;
            border: 2px solid #333;
            border-radius: 12px;
            box-shadow: 3px 3px 0px rgba(0,0,0,0.2);
            font-size: 16px;
            z-index: 90;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: default;
        }
        
        #work-timer {
            font-family: monospace;
            font-weight: bold;
            color: #555;
            background: #eee;
            padding: 2px 6px;
            border-radius: 4px;
            min-width: 50px;
            text-align: center;
        }

        /* === 2. å® ç‰©å®¹å™¨ (è´Ÿè´£ä½ç½®ä¸æ‹–æ‹½) === */
        #pet-container {
            position: absolute;
            width: 10px;
            height: 10px;
            cursor: grab;
            z-index: 100;
            /* å±…ä¸­å®šä½ */
            top: 50%;
            left: 50%;
            margin-top: -80px; 
            margin-left: -80px;
            /* åªæœ‰ transform æœ‰è¿‡æ¸¡ï¼Œä¿è¯æ‹–æ‹½è·Ÿæ‰‹ */
            transition: transform 0.2s ease;
        }
        
        #pet-container:active {
            cursor: grabbing;
        }

        /* === 3. è§†è§‰ä¸»ä½“ (è´Ÿè´£åŠ¨ç”»æ¼”ç») === */
        .leopard-visual {
            font-size: 100px; /* å¦‚æœæ¢å›¾ç‰‡ï¼Œè¿™é‡Œæ”¹ä¸º width: 100%; */
            text-align: center;
            line-height: 160px;
            filter: drop-shadow(4px 4px 0px rgba(0,0,0,0.15));
            pointer-events: none; /* é¼ æ ‡ç©¿é€ï¼Œç‚¹å‡»äº‹ä»¶ç”±çˆ¶å®¹å™¨å¤„ç† */
            /* é»˜è®¤çŠ¶æ€ï¼šé—²ç½®å‘¼å¸ */
            animation: idle-bounce 2s infinite ease-in-out;
        }

        /* === 4. æ°”æ³¡æç¤ºæ¡† === */
        .bubble {
            position: absolute;
            bottom: 150px; 
            left: 50%;
            transform: translateX(-50%);
            background: #fff;
            border: 3px solid #333;
            padding: 12px;
            border-radius: 18px 18px 18px 4px;
            width: 220px;
            display: none; /* é»˜è®¤éšè— */
            box-shadow: 4px 4px 0 rgba(0,0,0,0.15);
            text-align: center;
            z-index: 110;
        }

        .bubble h3 { margin: 0 0 6px 0; font-size: 16px; color: #d35400; }
        .bubble p { margin: 0 0 8px 0; font-size: 14px; color: #555; line-height: 1.4; }

        /* å€’è®¡æ—¶ç´§å¼ æ¨¡å¼ UI */
        .urgent-mode .bubble {
            border-color: #c0392b;
            background-color: #fff5f5;
            animation: shake-tiny 0.5s infinite;
        }
        .urgent-mode #action-title { color: #c0392b; font-weight: 800; font-size: 18px; }

        /* å€’è®¡æ—¶å¤§æ•°å­— */
        #countdown-display {
            font-size: 28px;
            font-weight: 900;
            color: #e74c3c;
            display: none;
            margin: 5px 0;
            text-shadow: 1px 1px 0 #fff;
        }

        /* æ‰“å¡æŒ‰é’® */
        #finish-btn {
            background: #f1c40f; /* é‡‘å¸é»„ */
            color: #333;
            border: 2px solid #333;
            padding: 8px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 800;
            display: none; 
            margin: 5px auto 0;
            font-size: 15px;
            box-shadow: 0 4px #d35400;
            transition: all 0.1s;
            pointer-events: auto; /* ç¡®ä¿æŒ‰é’®å¯ç‚¹ */
        }
        #finish-btn:active {
            box-shadow: 0 0 #d35400;
            transform: translateY(4px);
        }
        #finish-btn:hover {
            background: #f39c12;
        }

        /* === 5. åŠ¨æ•ˆç³»ç»Ÿ (æ ¸å¿ƒ) === */

        /* A. é—²ç½® */
        @keyframes idle-bounce {
            0%, 100% { transform: scale(1, 1) translateY(0); }
            50% { transform: scale(1.05, 0.95) translateY(6px); } 
        }

        /* B. å¤±è´¥é£èµ° (èºæ—‹å‡å¤©) */
        .anim-fly-away { animation: fly-away 1.5s forwards ease-in !important; }
        @keyframes fly-away {
            0% { transform: translate(0, 0) rotate(0deg) scale(1); opacity: 1; }
            20% { transform: translate(10px, -20px) rotate(-10deg); }
            100% { transform: translate(150px, -300px) rotate(120deg) scale(0); opacity: 0; }
        }

        /* C. åŠ¨ä½œï¼šæ—‹è½¬ (è½¬å¤´/è½¬è…°) */
        .anim-spin { animation: spin 2s infinite linear !important; }
        @keyframes spin { 
            0% { transform: rotate(0deg); } 
            25% { transform: rotate(-15deg); } 
            75% { transform: rotate(15deg); } 
            100% { transform: rotate(0deg); } 
        }

        /* D. åŠ¨ä½œï¼šæ‘‡æ™ƒ (æ‹’ç»/æ¨æ‰‹) */
        .anim-shake { animation: shake 1s infinite ease-in-out !important; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px) rotate(-5deg); }
            75% { transform: translateX(10px) rotate(5deg); }
        }

        /* E. åŠ¨ä½œï¼šå¼¹è·³ (æ·±è¹²/è€¸è‚©) */
        .anim-bounce { animation: bounce 0.8s infinite ease-in-out !important; }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* F. åŠ¨ä½œï¼šæ‹‰ä¼¸ (ä¼¸æ‡’è…°) */
        .anim-stretch { animation: stretch 1.5s infinite ease-in-out !important; }
        @keyframes stretch {
            0%, 100% { transform: scale(1, 1); }
            50% { transform: scale(0.9, 1.1) translateY(-10px); }
        }

        /* G. åŠ¨ä½œï¼šå‘¼å¸ (æ‰©èƒ¸/é™æ­¢å‘åŠ›) */
        .anim-breathe { animation: breathe-deep 2s infinite ease-in-out !important; }
        @keyframes breathe-deep {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }

        /* ç´§å¼ æ—¶çš„å¾®æŠ–åŠ¨ */
        @keyframes shake-tiny {
            0%, 100% { transform: translateX(-50%) rotate(0deg); }
            25% { transform: translateX(-51%) rotate(-1deg); }
            75% { transform: translateX(-49%) rotate(1deg); }
        }

        /* === 6. ç‰¹æ•ˆæ–‡å­— (é£˜å­—) === */
        .effect-text {
            position: absolute;
            font-weight: 900;
            pointer-events: none;
            left: 50%;
            transform: translateX(-50%);
            z-index: 300;
            width: 300px;
            text-align: center;
            font-size: 20px;
            text-shadow: 2px 2px 0 #fff;
            white-space: nowrap;
        }
        
        @keyframes float-up {
            0% { opacity: 1; top: -40px; transform: translateX(-50%) scale(0.8); }
            100% { opacity: 0; top: -150px; transform: translateX(-50%) scale(1.5); }
        }
    </style>
</head>
<body>

    <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
    <div id="piggy-bank">
        â³ <span id="work-timer">00:00</span>
        <span style="color:#ddd">|</span>
        ğŸ’° å­˜æ¬¾: <span id="money-count" style="color:#d35400; font-weight:bold;">0</span>
    </div>

    <!-- å® ç‰©ä¸»ä½“å®¹å™¨ -->
    <div id="pet-container">
        <!-- æ°”æ³¡ -->
        <div class="bubble" id="banner">
            <h3 id="action-title">å‡†å¤‡</h3>
            <p id="action-desc">...</p>
            <div id="countdown-display">10</div>
            <button id="finish-btn">ğŸ’° æ‰“å¡è¿›é’±</button>
        </div>
        
        <!-- è§†è§‰å½¢è±¡ (Emojiæˆ–å›¾ç‰‡) -->
        <div class="leopard-visual" id="leopard">ğŸ†</div>
    </div>

    <script>
        /**
         * âš™ï¸ é…ç½®åŒºåŸŸ
         * è°ƒè¯•æ¨¡å¼ï¼šWork=10ç§’, Exercise=15ç§’ (å…¶ä¸­æœ€å10ç§’å€’è®¡æ—¶)
         * æ­£å¼æ¨¡å¼ï¼šè¯·å°† WORK_TIME_SECONDS æ”¹ä¸º 25 * 60 (25åˆ†é’Ÿ)
         */
        const CONFIG = {
            WORK_TIME_SECONDS: 10,        // å·¥ä½œæ—¶é•¿ (ç§’)
            EXERCISE_TOTAL_SECONDS: 15,   // è¿åŠ¨æ€»æ—¶é•¿ (ç§’)
            URGENT_SECONDS: 10            // æœ€åç´§å¼ å€’è®¡æ—¶æ—¶é•¿ (ç§’)
        };

        // === 1. åºå¤§çš„åŠ¨ä½œæ•°æ®åº“ (52ç§) ===
        const exerciseLibrary = [
            // ğŸ¦’ é¢ˆéƒ¨/å¤´éƒ¨
            { t: "å¤©é¹…é¢ˆ", d: "ç”¨é¼»å°–åœ¨ç©ºä¸­å†™ä¸€ä¸ª'8'å­—ï¼Œå¯“æ„å‘å‘å‘", icon: "ğŸ¦’", anim: "anim-spin" },
            { t: "æ‹’ç»ç©·ç¥", d: "ç¼“æ…¢å·¦å³è½¬å¤´ï¼Œå¯¹ç©·ç¥åšå®šåœ°è¯´ä¸", icon: "ğŸ™…â€â™‚ï¸", anim: "anim-shake" },
            { t: "ä»°æœ›é‡‘å¸", d: "æŠ¬å¤´çœ‹å¤©èŠ±æ¿ï¼Œæƒ³è±¡ä¸Šé¢æ‰é‡‘å¸", icon: "ğŸ™„", anim: "anim-bounce" },
            { t: "ä¾§è€³å¬é’±", d: "å·¦è€³æ‰¾å·¦è‚©ï¼Œå³è€³æ‰¾å³è‚©ï¼Œå¬å¬é’±çš„å£°éŸ³", icon: "ğŸ‘‚", anim: "anim-shake" },
            { t: "ç¼©å¤´ä¹Œé¾Ÿ", d: "ä¿æŒä¸‹å·´æ°´å¹³å‘åç¼©ï¼ŒæŒ¤å‡ºåŒä¸‹å·´", icon: "ğŸ¢", anim: "anim-breathe" },
            { t: "å¤´é¡¶é¡¶é‡‘", d: "å¤´é¡¶ç”¨åŠ›å‘ä¸Šé¡¶ï¼Œåƒé¡¶ç€ä¸€å é’ç¥¨", icon: "ğŸ†™", anim: "anim-stretch" },
            { t: "å·¦å³å¯»å®", d: "å¤´å‘å·¦è½¬åˆ°åº•ï¼Œå†å‘å³è½¬åˆ°åº•", icon: "ğŸ‘€", anim: "anim-shake" },
            { t: "æ”¾æ¾å¤§è„‘", d: "ç”¨æ‰‹æŒ‡è½»è½»æ•²æ‰“å¤´çš®ï¼Œåƒä¸‹é‡‘å¸é›¨", icon: "ğŸ’†â€â™‚ï¸", anim: "anim-breathe" },

            // ğŸ¦… è‚©èƒŒ/ä¸Šè‚¢
            { t: "è€¸è‚©è—é‡‘", d: "ç”¨åŠ›è€¸è‚©æ‰¾è€³æœµï¼Œå¤¹ä½é‡‘å¸ä¸æ‰ä¸‹æ¥", icon: "ğŸ¤·â€â™‚ï¸", anim: "anim-bounce" },
            { t: "æ‘˜é‡‘è‹¹æœ", d: "å·¦æ‰‹å³æ‰‹è½®æµå‘ä¸Šç”¨åŠ›æŠ“å–ï¼é«˜å¤„æœ‰é’±ï¼", icon: "ğŸ™‹â€â™‚ï¸", anim: "anim-stretch" },
            { t: "æ‰©èƒ¸çº³è´¢", d: "åŒæ‰‹å‘åæ‰“å¼€ï¼Œåƒè¦æŠ±ä½ä¸€åº§é‡‘å±±", icon: "ğŸ¤—", anim: "anim-breathe" },
            { t: "èƒŒéƒ¨æ‹±æ¡¥", d: "åŒæ‰‹æŠ±èƒ¸ï¼ŒèƒŒéƒ¨å‘åæ‹±èµ·ï¼Œæ‹‰ä¼¸è„ŠæŸ±", icon: "ğŸ¦", anim: "anim-breathe" },
            { t: "Wå‹æ‹›è´¢", d: "æ‰‹è‡‚æ‘†æˆWå‹ï¼Œå‘åå¤¹ç´§è‚©èƒ›éª¨", icon: "ğŸ”±", anim: "anim-stretch" },
            { t: "å¤§é¹å±•ç¿…", d: "åŒè‡‚æ°´å¹³ä¼¸ç›´ï¼Œç”»å°åœ†åœˆ", icon: "ğŸ¦…", anim: "anim-spin" },
            { t: "èƒŒåæ¡æ‰‹", d: "åŒæ‰‹åœ¨èƒŒåäº¤æ¡ï¼ŒæŒºèµ·èƒ¸è†›", icon: "ğŸ¤", anim: "anim-stretch" },
            { t: "ç›´è‡‚ä¸‹å‹", d: "åŒè‡‚å‘ä¸‹ä¼¸ç›´ç”¨åŠ›æŒ‰å‹ï¼ŒæŠŠæµ®èºæŒ‰ä¸‹å»", icon: "ğŸ‘‡", anim: "anim-bounce" },

            // ğŸ‘ æ‰‹éƒ¨/æ‰‹è…•
            { t: "æ‹›è´¢çŒ«æ‰‹", d: "æ‰‹è…•ç”¨åŠ›å‘å¤–æ¨ï¼ŒæŠŠå‹åŠ›ç»Ÿç»Ÿæ¨èµ°", icon: "ğŸ‘", anim: "anim-shake" },
            { t: "æ•°é’±æŠ½ç­‹", d: "å¿«é€Ÿæ´»åŠ¨æ¯ä¸€æ ¹æ‰‹æŒ‡ï¼Œæ¨¡æ‹Ÿç‚¹é’æœº", icon: "ğŸ¹", anim: "anim-shake" },
            { t: "ç”©æ‰æ™¦æ°”", d: "åƒåˆšæ´—å®Œæ‰‹ä¸€æ ·ç”¨åŠ›ç”©æ‰‹è…•", icon: "ğŸ‘‹", anim: "anim-shake" },
            { t: "é‡‘åˆšé“æ‹³", d: "ç”¨åŠ›æ¡æ‹³5ç§’ï¼Œå†ç”¨åŠ›å¼ å¼€ç‚¸è£‚", icon: "âœŠ", anim: "anim-breathe" },
            { t: "ç¥ˆç¥·æ¶¨è–ª", d: "åŒæ‰‹åˆåï¼Œäº’ç›¸å¯¹æŠ—ç”¨åŠ›æ¨", icon: "ğŸ™", anim: "anim-breathe" },
            { t: "æ‰‹è…•ç”»åœˆ", d: "æ¡æ‹³ï¼Œæ‰‹è…•é¡ºæ—¶é’ˆç”»åœˆï¼Œåœˆä½è´¢å¯Œ", icon: "ğŸ‘Š", anim: "anim-spin" },
            { t: "å‹æŒ‡æ‹‰ä¼¸", d: "ä¸€åªæ‰‹æŠŠå¦ä¸€åªæ‰‹çš„æ‰‹æŒ‡æ‰‹è…•å‘åæ°", icon: "ğŸ–ï¸", anim: "anim-stretch" },
            { t: "å¼¹æŒ‡ç¥åŠŸ", d: "ç”¨åŠ›å¼¹å‡ºæ¯ä¸€æ ¹æ‰‹æŒ‡ï¼Œå‡»ç¢è´«ç©·", icon: "ğŸ‘Œ", anim: "anim-bounce" },

            // ğŸ’ƒ è…°è…¹/æ ¸å¿ƒ
            { t: "æ¡é’±å¼¯è…°", d: "åç€å‘å‰å¼¯è…°ï¼ŒæŒ‡å°–ç¢°è„šå°–", icon: "ğŸ™‡", anim: "anim-bounce" },
            { t: "è½¬è¿å‘¼å•¦åœˆ", d: "æƒ³è±¡è…°ä¸Šæœ‰ä¸ªå‘¼å•¦åœˆï¼Œæ…¢æ…¢è½¬åŠ¨", icon: "ğŸ¡", anim: "anim-spin" },
            { t: "å·¦å³é€¢æº", d: "ä¿æŒåå§¿ï¼Œä¸ŠåŠèº«å‘å·¦è½¬å†å‘å³è½¬", icon: "ğŸ¥¨", anim: "anim-shake" },
            { t: "ä¾§èº«æ‹¿é’±", d: "ä¸€åªæ‰‹å‘ä¸Šä¸¾ï¼Œèº«ä½“å‘å¦ä¸€ä¾§å¼¯æ›²", icon: "ğŸ‹", anim: "anim-shake" },
            { t: "æ”¶è…¹è—é’±", d: "ç”¨åŠ›æ”¶ç´§è‚šå­ï¼ŒåšæŒ10ç§’ï¼Œåˆ«è®©é’±æ‰å‡ºæ¥", icon: "ğŸ¤", anim: "anim-breathe" },
            { t: "æè†æ’é‡‘", d: "åå§¿æè†ï¼Œç”¨è†ç›–å»ç¢°æ‰‹è‚˜", icon: "ğŸ¦µ", anim: "anim-bounce" },
            { t: "åå§¿ä¼¸å±•", d: "åŒæ‰‹äº¤å‰å‘ä¸Šæ¨ï¼ŒæŠŠè…°æ‹”é•¿", icon: "ğŸ§˜", anim: "anim-stretch" },

            // ğŸ‘ è‡€éƒ¨/é«‹éƒ¨
            { t: "å¤¹ç´§é’±åŒ…", d: "ç”¨åŠ›æ”¶ç´§è‡€éƒ¨è‚Œè‚‰ï¼Œå¤¹ç´§ï¼åˆ«æ¾æ°”ï¼", icon: "ğŸ‘", anim: "anim-breathe" },
            { t: "äºŒéƒè…¿å…‹æ˜Ÿ", d: "è„šè¸æ”¾åœ¨è†ç›–ä¸Šï¼Œèº«ä½“å‰å€¾å‹ä¸€å‹", icon: "4ï¸âƒ£", anim: "anim-stretch" },
            { t: "åæ‹¥é‡‘å±±", d: "ç¦»å¼€æ¤…å­1å˜ç±³ï¼Œä¿æŒæ·±è¹²å§¿åŠ¿", icon: "ğŸª‘", anim: "anim-bounce" },
            { t: "æ‹æ‰“æ”¾æ¾", d: "ç”¨ç©ºå¿ƒæ‹³è½»è½»æ‹æ‰“è‡€éƒ¨ä¾§é¢", icon: "ğŸ‘‹", anim: "anim-shake" },
            { t: "å•è…¿æŠ¬èµ·", d: "åç€æŠŠä¸€æ¡è…¿ä¼¸ç›´æŠ¬èµ·ï¼Œæ„Ÿå—å¤§è…¿å‘åŠ›", icon: "ğŸ“", anim: "anim-stretch" },
            { t: "é«‹éƒ¨ç”»åœˆ", d: "ç«™èµ·æ¥ï¼Œç”¨èƒ¯éƒ¨ç”»ä¸€ä¸ªå¤§å¤§çš„åœ†", icon: "â­•", anim: "anim-spin" },
            { t: "åè¸¢è…¿", d: "ç«™ç«‹å‘åè¸¢è…¿ï¼ŒæŠŠéœ‰è¿è¸¢èµ°", icon: "ğŸ", anim: "anim-shake" },

            // ğŸ¦¶ è…¿éƒ¨/è„šéƒ¨
            { t: "æ­¥æ­¥é«˜å‡", d: "åŸåœ°è¸æ­¥ï¼Œè†ç›–æŠ¬é«˜ï¼", icon: "ğŸƒ", anim: "anim-bounce" },
            { t: "å‹¾è„šæ•°é’±", d: "è„šå°–ç”¨åŠ›å‘å›å‹¾ï¼Œæ‹‰ä¼¸å°è…¿", icon: "ğŸ©°", anim: "anim-stretch" },
            { t: "è¸®è„šæœ›è¿œ", d: "è„šè·ŸæŠ¬èµ·ï¼Œè„šå°–ç€åœ°ï¼Œçœ‹çœ‹è¿œå¤„çš„é’±", icon: "ğŸ•´ï¸", anim: "anim-stretch" },
            { t: "è„šè¸ç”»åœˆ", d: "è½¬åŠ¨è„šè¸ï¼Œé¡ºæ—¶é’ˆä¸‰åœˆï¼Œé€†æ—¶é’ˆä¸‰åœˆ", icon: "ğŸ¦¶", anim: "anim-spin" },
            { t: "è„šè¶¾æŠ“åœ°", d: "åƒç”¨è„šè¶¾æŠ“åœ°ä¸Šçš„ç¡¬å¸ä¸€æ ·ç”¨åŠ›", icon: "ğŸ¦…", anim: "anim-breathe" },
            { t: "éšå½¢è·‘æ­¥", d: "åœ¨æ¡Œå­åº•ä¸‹å¿«é€Ÿäº¤æ›¿è·ºè„š", icon: "ğŸ¾", anim: "anim-shake" },
            { t: "å°è…¿æŒ‰æ‘©", d: "ç”¨è„šè·Ÿå»è¹­å¦ä¸€æ¡è…¿çš„å°è…¿è‚š", icon: "ğŸ¦µ", anim: "anim-shake" },

            // ğŸ‘€ çœ¼ç›/é¢éƒ¨
            { t: "è‚¡å¸‚å¤§ç›˜", d: "çœ¼çƒä¸Šä¸‹çœ‹ï¼Œæ¨¡æ‹Ÿçœ‹Kçº¿å›¾èµ°åŠ¿", icon: "ğŸ‘€", anim: "anim-bounce" },
            { t: "å¯»æ‰¾å•†æœº", d: "é¡ºæ—¶é’ˆè½¬åŠ¨çœ¼çƒä¸¤åœˆï¼Œä¸æ”¾è¿‡ä»»ä½•æœºä¼š", icon: "ğŸ§", anim: "anim-spin" },
            { t: "ç¡®è®¤çœ¼ç¥", d: "ç”¨åŠ›é—­çœ¼3ç§’ï¼Œå†ç”¨åŠ›çå¼€", icon: "ğŸ˜Œ", anim: "anim-breathe" },
            { t: "è¿œçœºæœªæ¥", d: "çœ‹å‘çª—å¤–æœ€è¿œçš„åœ°æ–¹ï¼Œæ”¾æ¾ç«çŠ¶è‚Œ", icon: "ğŸ”­", anim: "anim-stretch" },
            { t: "ç‹®å­å¼€å£", d: "å¼ å¤§å˜´å·´ä¼¸å‡ºèˆŒå¤´ï¼Œæ”¾æ¾é¢éƒ¨è‚Œè‚‰", icon: "ğŸ¦", anim: "anim-stretch" },
            { t: "é¼“è…®çº³ç¦", d: "åƒæ²³è±šä¸€æ ·é¼“èµ·è…®å¸®å­ï¼Œæ†‹æ°”5ç§’", icon: "ğŸ¡", anim: "anim-breathe" },
            { t: "çœ‰å¼€çœ¼ç¬‘", d: "æŒ‘åŠ¨çœ‰æ¯›ï¼Œæ´»åŠ¨é¢å¤´", icon: "ğŸ¤¨", anim: "anim-shake" }
        ];

        // === ç´§å¼ æ—¶åˆ»æ–‡æ¡ˆåº“ ===
        const urgentTexts = [
            "æ•‘æ•‘ï¼æ•‘æ•‘è„–å­ï¼ğŸ˜±",
            "é’±è¦é£èµ°å•¦ï¼ğŸ’¸",
            "åˆ«åšç¡¬é‚¦é‚¦çš„çŸ³å¤´ï¼ğŸ—¿",
            "èº«ä½“æœ¬é’±è¦æ²¡å•¦ï¼ğŸ“‰",
            "å¿«åŠ¨åŠ¨ï¼è¦ç”Ÿé”ˆäº†ï¼ğŸ¤–",
            "ä¸ºäº†å…»è€é‡‘ï¼å†²å•Šï¼ğŸ‘µ",
            "é¢ˆæ¤åœ¨å°–å«å•Šï¼ğŸ“¢",
            "ä¸æƒ³å˜æˆé©¼èƒŒè±¹ï¼ğŸ†",
            "åŠ¨èµ·æ¥ï¼é’±åœ¨ç­‰ä½ ï¼ğŸ’°",
            "å¥åº·å€¼ -1 -1 -1 ğŸ“‰"
        ];

        // === State State Management ===
        const state = {
            isWorking: true,
            isExercising: false,
            money: 0,
            countdownTimer: null,
            workTimer: null
        };

        const elements = {
            pet: document.getElementById('pet-container'),
            leopard: document.getElementById('leopard'),
            bubble: document.getElementById('banner'),
            finishBtn: document.getElementById('finish-btn'),
            actionTitle: document.getElementById('action-title'),
            actionDesc: document.getElementById('action-desc'),
            countdownDisplay: document.getElementById('countdown-display'),
            moneyCount: document.getElementById('money-count'),
            workTimerDisplay: document.getElementById('work-timer')
        };

        // ==========================================
        // æ ¸å¿ƒé€»è¾‘ Loop Logic
        // ==========================================

        function startWorkLoop() {
            state.isWorking = true;
            resetVisuals();
            
            console.log("ğŸ’¼ å·¥ä½œå¾ªç¯å¼€å§‹");
            let remaining = CONFIG.WORK_TIME_SECONDS;
            updateTimerUI(remaining);

            // å¯åŠ¨å€’è®¡æ—¶
            if(state.workTimer) clearInterval(state.workTimer);
            state.workTimer = setInterval(() => {
                remaining--;
                updateTimerUI(remaining);

                if (remaining <= 0) {
                    clearInterval(state.workTimer);
                    startExercise();
                }
            }, 1000);
        }

        function updateTimerUI(seconds) {
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            elements.workTimerDisplay.innerText = `${m}:${s}`;
        }

        function startExercise() {
            state.isWorking = false;
            state.isExercising = true;
            
            // æ’­æ”¾éŸ³æ•ˆ (æ­¤å¤„éœ€æ¥å…¥Audioå¯¹è±¡)
            console.log("ğŸ”” è¿åŠ¨æ—¶é—´åˆ°!");

            // 1. éšæœºè·å–åŠ¨ä½œ
            const action = exerciseLibrary[Math.floor(Math.random() * exerciseLibrary.length)];
            
            // 2. æ›´æ–°UIå†…å®¹
            elements.actionTitle.innerText = action.t;
            elements.actionDesc.innerText = action.d;
            elements.leopard.innerText = action.icon;
            
            // 3. åº”ç”¨ CSS åŠ¨ç”» (å…ˆç§»é™¤æ—§çš„)
            elements.leopard.className = "leopard-visual"; // é‡ç½®class
            void elements.leopard.offsetWidth; // è§¦å‘é‡ç»˜
            elements.leopard.classList.add(action.anim); // æ·»åŠ æ–°åŠ¨ç”»

            // 4. æ˜¾ç¤ºæ°”æ³¡
            elements.bubble.style.display = 'block';
            elements.actionDesc.style.display = 'block';
            elements.finishBtn.style.display = 'none';
            elements.countdownDisplay.style.display = 'none';

            // 5. è®¾ç½®ç´§å¼ æ¨¡å¼å®šæ—¶å™¨
            const instructionTime = (CONFIG.EXERCISE_TOTAL_SECONDS - CONFIG.URGENT_SECONDS) * 1000;
            setTimeout(() => {
                startCountdownSequence();
            }, instructionTime);
        }

        function startCountdownSequence() {
            if (!state.isExercising) return;

            // 1. éšæœºç´§å¼ æ–‡æ¡ˆ
            const randomText = urgentTexts[Math.floor(Math.random() * urgentTexts.length)];
            
            // 2. åˆ‡æ¢UIåˆ°ç´§å¼ æ¨¡å¼
            elements.pet.classList.add('urgent-mode');
            elements.actionTitle.innerText = randomText;
            elements.actionDesc.style.display = 'none'; // éšè—æè¿°
            elements.finishBtn.style.display = 'block'; // æ˜¾ç¤ºæŒ‰é’®
            elements.countdownDisplay.style.display = 'block';
            
            let secondsLeft = CONFIG.URGENT_SECONDS;
            elements.countdownDisplay.innerText = secondsLeft;

            // 3. å€’è®¡æ—¶é€»è¾‘
            if(state.countdownTimer) clearInterval(state.countdownTimer);
            state.countdownTimer = setInterval(() => {
                secondsLeft--;
                elements.countdownDisplay.innerText = secondsLeft;

                if (secondsLeft <= 0) {
                    handleTimeout(); // è¶…æ—¶æœªæ‰“å¡
                }
            }, 1000);
        }

        // === å¤„ç†è¶…æ—¶ (é£èµ°æƒ©ç½š) ===
        function handleTimeout() {
            clearInterval(state.countdownTimer);
            
            // 1. è§†è§‰åé¦ˆï¼šé’±é£èµ°äº†
            elements.leopard.innerText = "ğŸ’¸"; 
            // å¼ºåˆ¶è¦†ç›–åŠ¨ç”»ä¸ºé£èµ°
            elements.leopard.className = "leopard-visual anim-fly-away";
            
            // 2. UI æ›´æ–°
            elements.actionTitle.innerText = "é£èµ°äº†...";
            elements.finishBtn.style.display = 'none';
            elements.countdownDisplay.style.display = 'none';
            
            // 3. ç‰¹æ•ˆ
            showEffect("èº«ä½“æœ¬é’± -1", "#7f8c8d");

            // 4. å»¶è¿Ÿåè¿›å…¥ä¸‹ä¸€è½®
            setTimeout(() => {
                state.isExercising = false;
                startWorkLoop();
            }, 1600);
        }

        // === å¤„ç†æˆåŠŸ (æ‰“å¡è¿›é’±) ===
        elements.finishBtn.addEventListener('click', (e) => {
            e.stopPropagation(); // é˜²æ­¢æ‹–æ‹½
            if (state.countdownTimer) clearInterval(state.countdownTimer);
            completeAndReward();
        });

        function completeAndReward() {
            state.isExercising = false;
            
            // 1. è§†è§‰åé¦ˆï¼šå¼€å¿ƒ
            elements.leopard.innerText = "ğŸ¤‘"; 
            elements.leopard.className = "leopard-visual"; // ç§»é™¤åŠ¨ä½œåŠ¨ç”»
            elements.leopard.style.animation = "idle-bounce 0.4s infinite"; // å¿«é€Ÿå¼€å¿ƒè·³
            
            // 2. åŠ é’±
            addMoney(10);
            
            // 3. å»¶è¿Ÿæ¢å¤
            setTimeout(() => {
                startWorkLoop();
            }, 1500);
        }

        // === è¾…åŠ©åŠŸèƒ½ ===

        function resetVisuals() {
            elements.pet.classList.remove('urgent-mode');
            elements.bubble.style.display = 'none';
            
            elements.leopard.innerText = "ğŸ†";
            elements.leopard.className = "leopard-visual"; // æ¢å¤é»˜è®¤å‘¼å¸åŠ¨ç”»
            // æ¸…é™¤è¡Œå†…æ ·å¼å¯èƒ½é—ç•™çš„ animation
            elements.leopard.style.animation = ""; 
        }

        function addMoney(amount) {
            state.money += amount;
            elements.moneyCount.innerText = state.money;
            showEffect("+ğŸ’° æ‰“å¡è¿›è´¦", "#f1c40f");
        }

        function showEffect(text, color) {
            const effect = document.createElement('div');
            effect.className = 'effect-text';
            effect.innerText = text;
            effect.style.color = color;
            effect.style.animation = "float-up 1.5s forwards";
            elements.pet.appendChild(effect);
            
            setTimeout(() => effect.remove(), 1500);
        }

        // ç‚¹å‡»äº’åŠ¨ (ä»…é—²ç½®æ—¶)
        elements.pet.addEventListener('click', () => {
            if (state.isExercising) return;
            // ç®€å•çš„äº¤äº’åé¦ˆ
            const randomFace = ["ğŸ˜¸", "ğŸ˜º", "ğŸ˜½"];
            elements.leopard.innerText = randomFace[Math.floor(Math.random() * randomFace.length)];
            setTimeout(() => elements.leopard.innerText = "ğŸ†", 800);
        });

        // ==========================================
        // æ‹–æ‹½é€»è¾‘ (Drag Logic)
        // ==========================================
        let isDragging = false;
        let dragStartX, dragStartY, initialLeft, initialTop;

        elements.pet.addEventListener('mousedown', (e) => {
            // å…è®¸å…¨çŠ¶æ€æ‹–æ‹½
            isDragging = true;
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            
            const rect = elements.pet.getBoundingClientRect();
            // åˆå§‹åŒ–ä½ç½®ï¼ˆå¤„ç†ç¬¬ä¸€æ¬¡å±…ä¸­å®šä½åçš„ absolute å€¼ï¼‰
            if (!elements.pet.style.left) {
                elements.pet.style.left = (rect.left + rect.width/2) + 'px';
                elements.pet.style.top = (rect.top + rect.height/2) + 'px';
            }
            initialLeft = parseFloat(elements.pet.style.left);
            initialTop = parseFloat(elements.pet.style.top);
            
            elements.pet.style.cursor = 'grabbing';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            const dx = e.clientX - dragStartX;
            const dy = e.clientY - dragStartY;
            elements.pet.style.left = (initialLeft + dx) + 'px';
            elements.pet.style.top = (initialTop + dy) + 'px';
            // æ‹–æ‹½æ—¶æ¸…ç©º transform ä¿è¯ä¸å†²çª (é™¤äº† scale/rotate é‚£äº›æ˜¯è§†è§‰å±‚åšçš„)
            // è¿™é‡Œçš„ transform æ˜¯ç”± CSS class æ§åˆ¶çš„ï¼Œä¸å½±å“ left/top
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            elements.pet.style.cursor = 'grab';
        });

        // ğŸš€ å¯åŠ¨ï¼
        startWorkLoop();

    </script>
</body>
</html>